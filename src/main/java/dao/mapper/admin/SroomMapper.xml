<?xml version="1.0" encoding="UTF-8"?>

<!-- 마이바티스 3 Mapper DTD -->
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="dao.face.admin.SroomDao_admin">

	<select id="selectCntAll" resultType="int">
		SELECT count(*) FROM studyroom
	</select>
	
	<select id="selectList" resultType="StudyRoom" parameterType="util.Paging">
		SELECT * FROM (
			SELECT rownum rnum, S.* FROM (
				SELECT
					sroom_no, sroom_name, sroom_addr, sroom_price, sroom_people
					, sroom_intro, sroom_info, sroom_role
				FROM studyroom
				ORDER BY sroom_no DESC
			) S
		) STUDYROOM
		WHERE rnum BETWEEN #{startNo } AND #{endNo } 
	</select>
    
    <insert id="insertsRoom" parameterType="StudyRoom">
    	<selectKey order="BEFORE" resultType="int" keyProperty="sRoomNo">
    		SELECT studyroom_seq.nextval FROM dual
    	</selectKey>
    
    	INSERT INTO studyroom ( sroom_no, sroom_name, sroom_addr, sroom_price, sroom_people, sroom_intro, sroom_info, sroom_role )
    	VALUES ( #{sRoomNo }, #{sRoomName }, #{sRoomAddr }, #{sRoomPrice }, #{sRoomPeople }, #{sRoomIntro }, #{sRoomInfo }, #{sRoomRole }  )
    </insert>
    
    <insert id="insertFile" parameterType="FileUpload">
    	INSERT INTO fileupload ( fileupload_no, sroom_no, fileupload_ori, fileupload_stor )
    	VALUES ( fileupload_seq.nextval, #{sroomNo }, #{fileUploadOri }, #{fileUploadStor } )
    </insert>
    
</mapper>