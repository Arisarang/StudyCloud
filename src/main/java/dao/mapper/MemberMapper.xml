<?xml version="1.0" encoding="UTF-8"?>

<!-- 마이바티스 3 Mapper DTD -->
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dao.face.MemberDao">
	<select id="selectCntMember" resultType="int" parameterType="Member">
		SELECT count(*) FROM member
		WHERE member_id = #{memberId} AND member_pw = #{memberPw}
	</select>

	<select id="selectMemberNick" resultType="string" parameterType="Member">
		SELECT member_nick FROM member
		WHERE member_id = #{memberId}
	</select>
	
	<select id="selectMemberNo" resultType="string" parameterType="Member">
		SELECT member_no FROM member
		WHERE member_id = #{memberId}
	</select>
	
	<select id="selectCntById" resultType="int" parameterType="Member">
		SELECT count(*) FROM member
		WHERE member_id = #{memberId}
	</select>

	<insert id="insert" parameterType="Member">
		<selectKey order="BEFORE" resultType="int" keyProperty="memberNo">
			SELECT member_seq.nextval FROM dual
		</selectKey>
	INSERT INTO member ( member_no, member_id, member_pw, member_email,
	member_name, member_nick, member_phone )
	VALUES ( member_seq.nextval, #{memberId}, #{memberPw}, #{memberEmail},
	#{memberName}, #{memberNick}, #{memberPhone} )
	</insert>
	
	<select id="getMemberById" parameterType="String" resultType="Member">
      Select 
         member_no memberNo,
         member_id memberId,
         member_email memberEmail,
         member_name memberName,
         member_nick memberNick,
         authority,
         member_phone memberPhone,
         member_pw memberPw  
      from 
         member
      where member_id = #{id}
   </select>


	<!-- 비밀번호 변경 -->
	<update id="updatePw">
		UPDATE member SET member_pw = #{memberPw}
		WHERE member_email = #{memberEmail}
	</update>

	<select id="readMember" parameterType="Member" resultType="int">
		SELECT count(*) FROM member
		WHERE member_email = #{memberEmail}
	</select>
	
	<select id="selectMemberByEmail" parameterType="String" resultType="Member">
		SELECT  
			 member_no memberNo,
	         member_id memberId,
	         member_email memberEmail,
	         member_name memberName,
	         member_nick memberNick,
	         authority,
	         member_phone memberPhone  
         FROM 
         	member
		WHERE 
			member_email = #{memberEmail}
	</select>
	
	
	<!-- 아이디 중복 체크 -->
	<select id="idchk" resultType="int" parameterType="String">
		SELECT count(*) FROM member
		WHERE member_id = #{memberId}
	</select>
	
	
	<!--  -->	
	<select id="getMemberByMemberNo" parameterType="Member" resultType="Member">
      Select 
         member_no,
         member_id,
         member_email,
         member_name,
         member_nick,
         authority,
         member_phone
      from 
         member
      where member_no = #{memberNo}
   </select>
</mapper>